/*! Copyright (c) 2017 Pair - pair-deep-image - Wed Dec 20 2017 15:40:50 */
var PairCache={enabled:!1,files:{},add:function(a,b){!1!==this.enabled&&(this.files[a]=b)},get:function(a){if(!1!==this.enabled)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};THREE.PairFileLoader=function(a){this.manager=a},THREE.PairFileLoader.prototype={constructor:THREE.PairFileLoader,load:function(a,b,c,d){void 0===a&&(a=""),void 0!==this.path&&(a=this.path+a);var e=this,f=PairCache.get(a);if(void 0!==f)return e.manager.itemStart(a),setTimeout(function(){b&&b(f),e.manager.itemEnd(a)},0),f;var g=/^data:(.*?)(;base64)?,(.*)$/,h=a.match(g);if(h){var i=h[1],j=!!h[2],k=h[3];k=window.decodeURIComponent(k),j&&(k=window.atob(k));try{var l,m=(this.responseType||"").toLowerCase();switch(m){case"arraybuffer":case"blob":l=new ArrayBuffer(k.length);for(var n=new Uint8Array(l),o=0;o<k.length;o++)n[o]=k.charCodeAt(o);"blob"===m&&(l=new Blob([l],{type:i}));break;case"document":var p=new DOMParser;l=p.parseFromString(k,i);break;case"json":l=JSON.parse(k);break;default:l=k}window.setTimeout(function(){b&&b(l),e.manager.itemEnd(a)},0)}catch(b){window.setTimeout(function(){d&&d(b),e.manager.itemError(a)},0)}}else{var q=new XMLHttpRequest;q.open("GET",a,!0),q.addEventListener("load",function(c){var f=c.target.response;PairCache.add(a,f),200===this.status?(b&&b(f),e.manager.itemEnd(a)):0===this.status?(console.warn("THREE.FileLoader: HTTP Status 0 received."),b&&b(f),e.manager.itemEnd(a)):(d&&d(c),e.manager.itemError(a))},!1),void 0!==c&&q.addEventListener("progress",function(a){c(a)},!1),q.addEventListener("error",function(b){d&&d(b),e.manager.itemError(a)},!1),void 0!==this.responseType&&(q.responseType=this.responseType),void 0!==this.withCredentials&&(q.withCredentials=this.withCredentials),q.overrideMimeType&&q.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),q.send(null)}return e.manager.itemStart(a),q},setPath:function(a){return this.path=a,this},setResponseType:function(a){return this.responseType=a,this},setWithCredentials:function(a){return this.withCredentials=a,this},setMimeType:function(a){return this.mimeType=a,this}},THREE.PairOBJLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager,this.materials=null,this.regexp={vertex_pattern:/^v\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,normal_pattern:/^vn\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,uv_pattern:/^vt\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,face_vertex:/^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/,face_vertex_uv:/^f\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+))?/,face_vertex_uv_normal:/^f\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+)\/(-?\d+))?/,face_vertex_normal:/^f\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)(?:\s+(-?\d+)\/\/(-?\d+))?/,object_pattern:/^[og]\s*(.+)?/,smoothing_pattern:/^s\s+(\d+|on|off)/,material_library_pattern:/^mtllib /,material_use_pattern:/^usemtl /}},THREE.PairOBJLoader.prototype={constructor:THREE.PairOBJLoader,load:function(a,b,c,d){if(window._pair_obj_cache||(window._pair_obj_cache={}),window._pair_obj_cache[a]){var e=window._pair_obj_cache[a];return void b(this.parse(e))}var f=this,g=new THREE.PairFileLoader(f.manager);g.setPath(this.path),g.load(a,function(c){window._pair_obj_cache&&(window._pair_obj_cache[a]=c),b(f.parse(c))},c,d)},setPath:function(a){this.path=a},setMaterials:function(a){this.materials=a},_createParserState:function(){var a={objects:[],object:{},vertices:[],normals:[],uvs:[],materialLibraries:[],startObject:function(a,b){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=a,void(this.object.fromDeclaration=!1!==b);var c=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:a||"",fromDeclaration:!1!==b,geometry:{vertices:[],normals:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(a,b){var c=this._finalize(!1);c&&(c.inherited||c.groupCount<=0)&&this.materials.splice(c.index,1);var d={index:this.materials.length,name:a||"",mtllib:Array.isArray(b)&&b.length>0?b[b.length-1]:"",smooth:void 0!==c?c.smooth:this.smooth,groupStart:void 0!==c?c.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(a){var b={index:"number"==typeof a?a:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return b.clone=this.clone.bind(b),b}};return this.materials.push(d),d},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(a){var b=this.currentMaterial();if(b&&-1===b.groupEnd&&(b.groupEnd=this.geometry.vertices.length/3,b.groupCount=b.groupEnd-b.groupStart,b.inherited=!1),a&&this.materials.length>1)for(var c=this.materials.length-1;c>=0;c--)this.materials[c].groupCount<=0&&this.materials.splice(c,1);return a&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),b}},c&&c.name&&"function"==typeof c.clone){var d=c.clone(0);d.inherited=!0,this.object.materials.push(d)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(a,b){var c=parseInt(a,10);return 3*(c>=0?c-1:c+b/3)},parseNormalIndex:function(a,b){var c=parseInt(a,10);return 3*(c>=0?c-1:c+b/3)},parseUVIndex:function(a,b){var c=parseInt(a,10);return 2*(c>=0?c-1:c+b/2)},addVertex:function(a,b,c){var d=this.vertices,e=this.object.geometry.vertices;e.push(d[a+0]),e.push(d[a+1]),e.push(d[a+2]),e.push(d[b+0]),e.push(d[b+1]),e.push(d[b+2]),e.push(d[c+0]),e.push(d[c+1]),e.push(d[c+2])},addVertexLine:function(a){var b=this.vertices,c=this.object.geometry.vertices;c.push(b[a+0]),c.push(b[a+1]),c.push(b[a+2])},addNormal:function(a,b,c){var d=this.normals,e=this.object.geometry.normals;e.push(d[a+0]),e.push(d[a+1]),e.push(d[a+2]),e.push(d[b+0]),e.push(d[b+1]),e.push(d[b+2]),e.push(d[c+0]),e.push(d[c+1]),e.push(d[c+2])},addUV:function(a,b,c){var d=this.uvs,e=this.object.geometry.uvs;e.push(d[a+0]),e.push(d[a+1]),e.push(d[b+0]),e.push(d[b+1]),e.push(d[c+0]),e.push(d[c+1])},addUVLine:function(a){var b=this.uvs,c=this.object.geometry.uvs;c.push(b[a+0]),c.push(b[a+1])},addFace:function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n=this.vertices.length,o=this.parseVertexIndex(a,n),p=this.parseVertexIndex(b,n),q=this.parseVertexIndex(c,n);if(void 0===d?this.addVertex(o,p,q):(m=this.parseVertexIndex(d,n),this.addVertex(o,p,m),this.addVertex(p,q,m)),void 0!==e){var r=this.uvs.length;o=this.parseUVIndex(e,r),p=this.parseUVIndex(f,r),q=this.parseUVIndex(g,r),void 0===d?this.addUV(o,p,q):(m=this.parseUVIndex(h,r),this.addUV(o,p,m),this.addUV(p,q,m))}if(void 0!==i){var s=this.normals.length;o=this.parseNormalIndex(i,s),p=i===j?o:this.parseNormalIndex(j,s),q=i===k?o:this.parseNormalIndex(k,s),void 0===d?this.addNormal(o,p,q):(m=this.parseNormalIndex(l,s),this.addNormal(o,p,m),this.addNormal(p,q,m))}},addLineGeometry:function(a,b){this.object.geometry.type="Line";for(var c=this.vertices.length,d=this.uvs.length,e=0,f=a.length;e<f;e++)this.addVertexLine(this.parseVertexIndex(a[e],c));for(var g=0,f=b.length;g<f;g++)this.addUVLine(this.parseUVIndex(b[g],d))}};return a.startObject("",!1),a},parse:function(a){var b=this._createParserState();-1!==a.indexOf("\r\n")&&(a=a.replace(/\r\n/g,"\n")),-1!==a.indexOf("\\\n")&&(a=a.replace(/\\\n/g,""));for(var c=a.split("\n"),d="",e="",f="",g=[],h="function"==typeof"".trimLeft,i=0,j=c.length;i<j;i++)if(d=c[i],d=h?d.trimLeft():d.trim(),0!==d.length&&"#"!==(e=d.charAt(0)))if("v"===e)if(" "===(f=d.charAt(1))&&null!==(g=this.regexp.vertex_pattern.exec(d)))b.vertices.push(parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3]));else if("n"===f&&null!==(g=this.regexp.normal_pattern.exec(d)))b.normals.push(parseFloat(g[1]),parseFloat(g[2]),parseFloat(g[3]));else{if("t"!==f||null===(g=this.regexp.uv_pattern.exec(d)))throw new Error("Unexpected vertex/normal/uv line: '"+d+"'");b.uvs.push(parseFloat(g[1]),parseFloat(g[2]))}else if("f"===e)if(null!==(g=this.regexp.face_vertex_uv_normal.exec(d)))b.addFace(g[1],g[4],g[7],g[10],g[2],g[5],g[8],g[11],g[3],g[6],g[9],g[12]);else if(null!==(g=this.regexp.face_vertex_uv.exec(d)))b.addFace(g[1],g[3],g[5],g[7],g[2],g[4],g[6],g[8]);else if(null!==(g=this.regexp.face_vertex_normal.exec(d)))b.addFace(g[1],g[3],g[5],g[7],void 0,void 0,void 0,void 0,g[2],g[4],g[6],g[8]);else{if(null===(g=this.regexp.face_vertex.exec(d)))throw new Error("Unexpected face line: '"+d+"'");b.addFace(g[1],g[2],g[3],g[4])}else if("l"===e){var k=d.substring(1).trim().split(" "),l=[],m=[];if(-1===d.indexOf("/"))l=k;else for(var n=0,o=k.length;n<o;n++){var p=k[n].split("/");""!==p[0]&&l.push(p[0]),""!==p[1]&&m.push(p[1])}b.addLineGeometry(l,m)}else if(null!==(g=this.regexp.object_pattern.exec(d))){var q=(" "+g[0].substr(1).trim()).substr(1);b.startObject(q)}else if(this.regexp.material_use_pattern.test(d))b.object.startMaterial(d.substring(7).trim(),b.materialLibraries);else if(this.regexp.material_library_pattern.test(d))b.materialLibraries.push(d.substring(7).trim());else{if(null===(g=this.regexp.smoothing_pattern.exec(d))){if("\0"===d)continue;throw new Error("Unexpected line: '"+d+"'")}var r=g[1].trim().toLowerCase();b.object.smooth="1"===r||"on"===r;var s=b.object.currentMaterial();s&&(s.smooth=b.object.smooth)}b.finalize();var t=new THREE.Group;t.materialLibraries=[].concat(b.materialLibraries);for(var i=0,j=b.objects.length;i<j;i++){var u=b.objects[i],v=u.geometry,w=u.materials,x="Line"===v.type;if(0!==v.vertices.length){var y=new THREE.BufferGeometry;y.addAttribute("position",new THREE.BufferAttribute(new Float32Array(v.vertices),3)),v.normals.length>0?y.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(v.normals),3)):y.computeVertexNormals(),v.uvs.length>0&&y.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(v.uvs),2));for(var z=[],A=0,B=w.length;A<B;A++){var C=w[A],s=void 0;if(null!==this.materials&&(s=this.materials.create(C.name),x&&s&&!(s instanceof THREE.LineBasicMaterial))){var D=new THREE.LineBasicMaterial;D.copy(s),s=D}s||(s=x?new THREE.LineBasicMaterial:new THREE.MeshPhongMaterial,s.name=C.name),s.shading=C.smooth?THREE.SmoothShading:THREE.FlatShading,z.push(s)}var E;if(z.length>1){for(var A=0,B=w.length;A<B;A++){var C=w[A];y.addGroup(C.groupStart,C.groupCount,A)}var F=new THREE.MultiMaterial(z);E=x?new THREE.LineSegments(y,F):new THREE.Mesh(y,F)}else E=x?new THREE.LineSegments(y,z[0]):new THREE.Mesh(y,z[0]);E.name=u.name,t.add(E)}}return t}},THREE.PairMTLLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager},THREE.PairMTLLoader.prototype={constructor:THREE.PairMTLLoader,load:function(a,b,c,d){if(window._pair_mtl_cache||(window._pair_mtl_cache={}),window._pair_mtl_cache[a]){var e=window._pair_mtl_cache[a];return void b(this.parse(e))}var f=this,g=new THREE.PairFileLoader(this.manager);g.setPath(this.path),g.load(a,function(c){window._pair_mtl_cache&&(window._pair_mtl_cache[a]=c),b(f.parse(c))},c,d)},setPath:function(a){this.path=a},setTexturePath:function(a){this.texturePath=a},setBaseUrl:function(a){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead."),this.setTexturePath(a)},setCrossOrigin:function(a){this.crossOrigin=a},setMaterialOptions:function(a){this.materialOptions=a},parse:function(a){for(var b=a.split("\n"),c={},d=/\s+/,e={},f=0;f<b.length;f++){var g=b[f];if(g=g.trim(),0!==g.length&&"#"!==g.charAt(0)){var h=g.indexOf(" "),i=h>=0?g.substring(0,h):g;i=i.toLowerCase();var j=h>=0?g.substring(h+1):"";if(j=j.trim(),"newmtl"===i)c={name:j},e[j]=c;else if(c)if("ka"===i||"kd"===i||"ks"===i){var k=j.split(d,3);c[i]=[parseFloat(k[0]),parseFloat(k[1]),parseFloat(k[2])]}else c[i]=j}}var l=new THREE.PairMTLLoader.MaterialCreator(this.texturePath||this.path,this.materialOptions);return l.setCrossOrigin(this.crossOrigin),l.setManager(this.manager),l.setMaterials(e),l}},THREE.PairMTLLoader.MaterialCreator=function(a,b){this.baseUrl=a||"",this.options=b,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.PairMTLLoader.MaterialCreator.prototype={constructor:THREE.PairMTLLoader.MaterialCreator,setCrossOrigin:function(a){this.crossOrigin=a},setManager:function(a){this.manager=a},setMaterials:function(a){this.materialsInfo=this.convert(a),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(a){if(!this.options)return a;var b={};for(var c in a){var d=a[c],e={};b[c]=e;for(var f in d){var g=!0,h=d[f],i=f.toLowerCase();switch(i){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(h=[h[0]/255,h[1]/255,h[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===h[0]&&0===h[1]&&0===h[2]&&(g=!1)}g&&(e[i]=h)}}return b},preload:function(){for(var a in this.materialsInfo)this.create(a)},getIndex:function(a){return this.nameLookup[a]},getAsArray:function(){var a=0;for(var b in this.materialsInfo)this.materialsArray[a]=this.create(b),this.nameLookup[b]=a,a++;return this.materialsArray},create:function(a){return void 0===this.materials[a]&&this.createMaterial_(a),this.materials[a]},createMaterial_:function(a){function b(a,b){return"string"!=typeof b||""===b?"":/^https?:\/\//i.test(b)?b:a+b}function c(a,c){if(!f[a]){var e=d.getTextureParams(c,f),g=d.loadTexture(b(d.baseUrl,e.url));g.repeat.copy(e.scale),g.offset.copy(e.offset),g.wrapS=d.wrap,g.wrapT=d.wrap,f[a]=g}}var d=this,e=this.materialsInfo[a],f={name:a,side:this.side},g=!1;for(var h in e){var i=e[h];if(""!==i)switch(h.toLowerCase()){case"kd":f.color=(new THREE.Color).fromArray(i);break;case"ks":f.specular=(new THREE.Color).fromArray(i);break;case"map_kd":pair.startsWith(i,"swatchTexture_")&&(g=!0),c("map",i);break;case"map_ks":c("specularMap",i);break;case"map_bump":case"bump":c("bumpMap",i);break;case"ns":f.shininess=parseFloat(i);break;case"d":i<1&&(f.opacity=i,f.transparent=!0);break;case"Tr":i>0&&(f.opacity=1-i,f.transparent=!0)}}return this.materials[a]=new THREE.MeshPhongMaterial(f),this.materials[a].pairIsSwatchMaterial=g,this.materials[a]},getTextureParams:function(a,b){var c,d={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},e=a.split(/\s+/);return c=e.indexOf("-bm"),c>=0&&(b.bumpScale=parseFloat(e[c+1]),e.splice(c,2)),c=e.indexOf("-s"),c>=0&&(d.scale.set(parseFloat(e[c+1]),parseFloat(e[c+2])),e.splice(c,4)),c=e.indexOf("-o"),c>=0&&(d.offset.set(parseFloat(e[c+1]),parseFloat(e[c+2])),e.splice(c,4)),d.url=e.join(" ").trim(),d},loadTexture:function(a,b,c,d,e){var f,g=THREE.Loader.Handlers.get(a),h=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;return null===g&&(g=new THREE.TextureLoader(h)),g.setCrossOrigin&&g.setCrossOrigin(this.crossOrigin),f=g.load(a,c,d,e),void 0!==b&&(f.mapping=b),f}},THREE.TrackballControls=function(a,b){function c(a){!1!==m.enabled&&(window.removeEventListener("keydown",c),r=q,q===n.NONE&&(a.keyCode!==m.keys[n.ROTATE]||m.noRotate?a.keyCode!==m.keys[n.ZOOM]||m.noZoom?a.keyCode!==m.keys[n.PAN]||m.noPan||(q=n.PAN):q=n.ZOOM:q=n.ROTATE))}function d(a){!1!==m.enabled&&(q=r,window.addEventListener("keydown",c,!1))}function e(a){!1!==m.enabled&&(a.preventDefault(),a.stopPropagation(),q===n.NONE&&(q=a.button),q!==n.ROTATE||m.noRotate?q!==n.ZOOM||m.noZoom?q!==n.PAN||m.noPan||(B.copy(G(a.pageX,a.pageY)),C.copy(B)):(x.copy(G(a.pageX,a.pageY)),y.copy(x)):(u.copy(H(a.pageX,a.pageY)),t.copy(u)),document.addEventListener("mousemove",f,!1),document.addEventListener("mouseup",g,!1),m.dispatchEvent(E))}function f(a){!1!==m.enabled&&(a.preventDefault(),a.stopPropagation(),q!==n.ROTATE||m.noRotate?q!==n.ZOOM||m.noZoom?q!==n.PAN||m.noPan||C.copy(G(a.pageX,a.pageY)):y.copy(G(a.pageX,a.pageY)):(t.copy(u),u.copy(H(a.pageX,a.pageY))))}function g(a){!1!==m.enabled&&(a.preventDefault(),a.stopPropagation(),q=n.NONE,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",g),m.dispatchEvent(F))}function h(a){if(!1!==m.enabled){switch(a.preventDefault(),a.stopPropagation(),a.deltaMode){case 2:x.y-=.025*a.deltaY;break;case 1:x.y-=.01*a.deltaY;break;default:x.y-=25e-5*a.deltaY}m.dispatchEvent(E),m.dispatchEvent(F)}}function i(a){if(!1!==m.enabled){switch(a.touches.length){case 1:q=n.TOUCH_ROTATE,u.copy(H(a.touches[0].pageX,a.touches[0].pageY)),t.copy(u);break;default:q=n.TOUCH_ZOOM_PAN;var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;A=z=Math.sqrt(b*b+c*c);var d=(a.touches[0].pageX+a.touches[1].pageX)/2,e=(a.touches[0].pageY+a.touches[1].pageY)/2;B.copy(G(d,e)),C.copy(B)}m.dispatchEvent(E)}}function j(a){if(!1!==m.enabled)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:t.copy(u),u.copy(H(a.touches[0].pageX,a.touches[0].pageY));break;default:var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY;A=Math.sqrt(b*b+c*c);var d=(a.touches[0].pageX+a.touches[1].pageX)/2,e=(a.touches[0].pageY+a.touches[1].pageY)/2;C.copy(G(d,e))}}function k(a){if(!1!==m.enabled){switch(a.touches.length){case 0:q=n.NONE;break;case 1:q=n.TOUCH_ROTATE,u.copy(H(a.touches[0].pageX,a.touches[0].pageY)),t.copy(u)}m.dispatchEvent(F)}}function l(a){a.preventDefault()}var m=this,n={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=a,this.domElement=void 0!==b?b:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=2,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=.5,this.maxDistance=10,this.onPanCallback=null,this.limitVerticalRotate=!0,this.keys=[65,83,68],this.target=new THREE.Vector3;var o=1e-6,p=new THREE.Vector3,q=n.NONE,r=n.NONE,s=new THREE.Vector3,t=new THREE.Vector2,u=new THREE.Vector2,v=new THREE.Vector3,w=0,x=new THREE.Vector2,y=new THREE.Vector2,z=0,A=0,B=new THREE.Vector2,C=new THREE.Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone();var D={type:"change"},E={type:"start"},F={type:"end"};this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var a=this.domElement.getBoundingClientRect(),b=this.domElement.ownerDocument.documentElement;this.screen.left=a.left+window.pageXOffset-b.clientLeft,this.screen.top=a.top+window.pageYOffset-b.clientTop,this.screen.width=a.width,this.screen.height=a.height}},this.handleEvent=function(a){"function"==typeof this[a.type]&&this[a.type](a)};var G=function(){var a=new THREE.Vector2;return function(b,c){return a.set((b-m.screen.left)/m.screen.width,(c-m.screen.top)/m.screen.height),a}}(),H=function(){var a=new THREE.Vector2;return function(b,c){return a.set((b-.5*m.screen.width-m.screen.left)/(.5*m.screen.width),(m.screen.height+2*(m.screen.top-c))/m.screen.width),a}}();this.rotateCamera=function(){var a,b=new THREE.Vector3,c=new THREE.Quaternion,d=new THREE.Vector3,e=new THREE.Vector3,f=new THREE.Vector3,g=new THREE.Vector3;return function(){if(g.set(u.x-t.x,u.y-t.y,0),a=g.length()){s.copy(m.object.position).sub(m.target);var h=new THREE.Vector3(0,1,0);c.setFromAxisAngle(h,(t.x-u.x)*m.rotateSpeed),s.applyQuaternion(c),m.object.up.applyQuaternion(c),d.copy(s).normalize(),e.copy(m.object.up).normalize(),f.crossVectors(e,d).normalize(),c.setFromAxisAngle(f,(u.y-t.y)*m.rotateSpeed*.5);var i=new THREE.Vector3;i.copy(s),s.applyQuaternion(c);var j=.75*s.length();m.limitVerticalRotate&&s.y<0?s.copy(i):m.limitVerticalRotate&&s.y>j?s.copy(i):m.object.up.applyQuaternion(c),m.onPanCallback&&m.onPanCallback(),v.copy(b),w=a}else!m.staticMoving&&w&&(w*=Math.sqrt(1-m.dynamicDampingFactor),s.copy(m.object.position).sub(m.target),c.setFromAxisAngle(v,w),s.applyQuaternion(c),m.object.up.applyQuaternion(c));t.copy(u)}}(),this.zoomCamera=function(){var a;q===n.TOUCH_ZOOM_PAN?(a=z/A,z=A,s.multiplyScalar(a)):(a=1+(y.y-x.y)*m.zoomSpeed,1!==a&&a>0&&s.multiplyScalar(a),m.staticMoving?x.copy(y):x.y+=(y.y-x.y)*this.dynamicDampingFactor)},this.panCamera=function(){var a=new THREE.Vector2,b=new THREE.Vector3,c=new THREE.Vector3;return function(){a.copy(C).sub(B),a.lengthSq()&&(a.multiplyScalar(s.length()*m.panSpeed),c.copy(s).cross(m.object.up).setLength(a.x),c.add(b.copy(m.object.up).setLength(a.y)),m.object.position.add(c),m.target.add(c),m.staticMoving?B.copy(C):B.add(a.subVectors(C,B).multiplyScalar(m.dynamicDampingFactor)))}}(),this.checkDistances=function(){m.noZoom&&m.noPan||(s.lengthSq()>m.maxDistance*m.maxDistance&&(m.object.position.addVectors(m.target,s.setLength(m.maxDistance)),x.copy(y)),s.lengthSq()<m.minDistance*m.minDistance&&(m.object.position.addVectors(m.target,s.setLength(m.minDistance)),x.copy(y)))},this.update=function(){s.subVectors(m.object.position,m.target),m.noRotate||m.rotateCamera(),m.noZoom||m.zoomCamera(),m.noPan||m.panCamera(),m.object.position.addVectors(m.target,s),m.checkDistances(),m.object.lookAt(m.target),p.distanceToSquared(m.object.position)>o&&(m.dispatchEvent(D),p.copy(m.object.position))},this.reset=function(){q=n.NONE,r=n.NONE,m.target.copy(m.target0),m.object.position.copy(m.position0),m.object.up.copy(m.up0),s.subVectors(m.object.position,m.target),m.object.lookAt(m.target),m.dispatchEvent(D),p.copy(m.object.position)},this.dispose=function(){this.domElement.removeEventListener("contextmenu",l,!1),this.domElement.removeEventListener("mousedown",e,!1),this.domElement.removeEventListener("wheel",h,!1),this.domElement.removeEventListener("touchstart",i,!1),this.domElement.removeEventListener("touchend",k,!1),this.domElement.removeEventListener("touchmove",j,!1),document.removeEventListener("mousemove",f,!1),document.removeEventListener("mouseup",g,!1),window.removeEventListener("keydown",c,!1),window.removeEventListener("keyup",d,!1)},this.domElement.addEventListener("contextmenu",l,!1),this.domElement.addEventListener("mousedown",e,!1),this.domElement.addEventListener("wheel",h,!1),this.domElement.addEventListener("touchstart",i,!1),this.domElement.addEventListener("touchend",k,!1),this.domElement.addEventListener("touchmove",j,{capture:!1,passive:!1}),window.addEventListener("keydown",c,!1),window.addEventListener("keyup",d,!1),this.handleResize(),this.update()},THREE.TrackballControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.TrackballControls.prototype.constructor=THREE.TrackballControls;var pair=pair||{};pair.isNullOrWhitespace=function(a){return!a||"string"!=typeof a||a.replace(/\s/g,"").length<1},pair.endsWith=function(a,b){return a.lastIndexOf(b)===a.length-b.length},pair.startsWith=function(a,b){return 0===a.indexOf(b)},pair.blackDotImage="data:image/png;base64,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",pair.spinnerImage="data:image/gif;base64,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",pair.dataURItoBlob=function(a){var b;b=a.split(",")[0].indexOf("base64")>=0?atob(a.split(",")[1]):unescape(a.split(",")[1]);for(var c=a.split(",")[0].split(":")[1].split(";")[0],d=new Uint8Array(b.length),e=0;e<b.length;e++)d[e]=b.charCodeAt(e);return new Blob([d],{type:c})},pair.DeepImageApiUri="https://app.pair3d.com/api/Vision/DeepImageCamera",pair.getOrientationFromDataUri=function(a,b){var c=pair.dataURItoBlob(a);return pair.getOrientation(c,b)},pair.getOrientation=function(a,b){var c=new FileReader;c.onload=function(a){var c=new DataView(a.target.result);if(65496!=c.getUint16(0,!1))return b(-2);for(var d=c.byteLength,e=2;e<d;){var f=c.getUint16(e,!1);if(e+=2,65505==f){if(1165519206!=c.getUint32(e+=2,!1))return b(-1);var g=18761==c.getUint16(e+=6,!1);e+=c.getUint32(e+4,g);var h=c.getUint16(e,g);e+=2;for(var i=0;i<h;i++)if(274==c.getUint16(e+12*i,g))return b(c.getUint16(e+12*i+8,g))}else{if(65280!=(65280&f))break;e+=c.getUint16(e,!1)}}return b(-1)},c.readAsArrayBuffer(a)},pair.isOrientationRotated90=function(a){return 5===a||6===a||7===a||8===a},pair.DeepImageErrorCode_NoError=0,pair.DeepImageErrorCode_FileTooLarge=1,pair.DeepImageErrorCode_UnsupportedFileType=2,pair.DeepImageErrorCode_ImageDimensionTooSmall=3,pair.DeepImageErrorCode_ImageDimensionTooLarge=4,pair.DeepImageErrorCode_UnsupportedImageRatio=5,pair.DeepImageErrorCode_FailedPoseDetection=6,pair.retrieveDeepImageScene=function(a,b,c,d){if(!b)return void console.log("You must set your Pair API key before processing a deep image.");var e=pair.dataURItoBlob(a),f=pair.DeepImageApiUri+"?visionApiKey="+b,g=new FormData;g.append("image",e);var h=function(a){if(a.lengthComputable){var b=a.loaded/a.total;d&&d(b)}};$.ajax({type:"POST",url:f,data:g,cache:!1,processData:!1,contentType:!1,xhr:function(){return myXhr=$.ajaxSettings.xhr(),myXhr.upload&&myXhr.upload.addEventListener("progress",h,!1),myXhr},success:function(a){c&&c(a)},error:function(a,b){c&&c(null)}})},pair.loadModelInfo=function(a,b){var c=[{swatchIndex:0,name:"",mtlName:"model.mtl",textureFileName:null,thumbnailFileName:null}];if(window._pair_info_cache||(window._pair_info_cache={}),window._pair_info_cache[a]){var d=window._pair_info_cache[a];return d=JSON.parse(d),void b(d)}$.getJSON(a,function(d){d.swatchOptions&&0!==d.swatchOptions.length||(d.swatchOptions=c),window._pair_info_cache[a]=JSON.stringify(d),b(d)}).fail(function(){var d={swatchOptions:c};window._pair_info_cache[a]=JSON.stringify(d),b(d)})},pair.loadModelFromBaseUri=function(a,b,c,d,e,f,g){pair.endsWith(a,"/")||(a+="/");var h=function(b,h){e&&e(.35),b&&(b.preload(),c.setMaterials(b));var i=function(a){var b=.35+a.loaded/a.total*.65*.99;e&&e(b)},j=a+(pair.isNullOrWhitespace(g)?"model":g)+".obj";c.load(j,function(b){e&&e(f?.99:1),b.pairBaseUri=a,b.swatchOptions=h.swatchOptions,b.activeSwatchIndex=0,b.setSwatchIndex=function(a,b){this.replaceSwatchTexture(a,b)},b.setSwatchByName=function(a,b){for(var c=0;c<this.swatchOptions.length;++c){if(this.swatchOptions[c].name===a)return void this.replaceSwatchTexture(c,b)}console.log("Unabled to find swatch option with name '"+a+"'"),b&&b(!1)},b.replaceSwatchTexture=function(a,b){if(a<0||a>=this.swatchOptions.length)return void console.log("Invalid swatch index: "+a);var c=this.swatchOptions[this.activeSwatchIndex];this.activeSwatchIndex=a;var d=this.swatchOptions[a],e=this.pairBaseUri+d.textureFileName,f=this;THREE.ImageUtils.crossOrigin="";var g=function(a){c.textureFileName;f.traverse(function(b){b instanceof THREE.Mesh&&b.material&&b.material.pairIsSwatchMaterial&&(b.material.map=a,b.material.needsUpdate=!0)}),f.pairViewer&&f.pairViewer.render(),d.buttonDomElem&&(d.buttonDomElem.style.border="solid 5px #0FA"),b&&b(!0)},h=function(a){b&&b(!1)},i=new THREE.TextureLoader;i.crossOrigin=!0,i.load(e,g,function(){},h)},f?b.setSwatchByName(f,function(){e&&e(1),d&&setTimeout(function(){d(b)},1)}):d&&setTimeout(function(){d(b)},1)},i,function(){console.log("Failed to load: "+a)})},i=function(a){var b=.1+a.loaded/a.total*.25;e&&e(b)},j=function(c){e&&e(.1);var d=(pair.isNullOrWhitespace(g)?"model":g)+".mtl";b.setPath(a),b.load(d,function(a){h(a,c)},i,function(){h(null,c)})},k=a+"model-info.json";pair.loadModelInfo(k,j)},"undefined"!=typeof THREE&&THREE.Cache&&(THREE.Cache.enabled=!0),pair.preloadModelFromBaseUri=function(a,b,c,d){var e=new THREE.PairOBJLoader,f=new THREE.PairMTLLoader;f.setCrossOrigin(!0),pair.loadModelFromBaseUri(a,f,e,null,b,c,d)};var pair=pair||{};pair.Interstitial=function(a){this.viewerDomElementId=a,this.domContainer=null,this.showLoadingBox=!0,this.camera=null,this.viewControls=null,this.scene=null,this.renderer=null,this.objLoader=null,this.mtlLoader=null,this.activeMesh=null,this.activeMeshRadius=0,this.isActive=!1,this.pauseAutoRotate=!1,this.unpauseRotateTimerId=-1,this.autoRotateSpeed=-.04*Math.PI,this.currentAutoRotateSpeed=0,this.loadingProgress_OutlineBox=null,this.loadingProgress_FillBox=null},pair.Interstitial.prototype={init:function(){this.domContainer=document.getElementById(this.viewerDomElementId);var a=this.domContainer.clientWidth||100,b=this.domContainer.clientHeight||100;this.camera=new THREE.PerspectiveCamera(60,a/b,.001,500),this.camera.position.z=500,this.objLoader=new THREE.PairOBJLoader,this.mtlLoader=new THREE.PairMTLLoader,this.mtlLoader.setCrossOrigin(!0),this.scene=new THREE.Scene;var c=new THREE.DirectionalLight(16777215);c.position.set(1,1,1),this.scene.add(c),c=new THREE.AmbientLight(10066329),this.scene.add(c),this.renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0}),this.renderer.setClearColor(16777215),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(a,b),this.renderer.setClearColor(0,0),this.domContainer.appendChild(this.renderer.domElement),this.viewControls=new THREE.TrackballControls(this.camera,this.renderer.domElement),this.viewControls.rotateSpeed=4,this.viewControls.zoomSpeed=1.2,this.viewControls.panSpeed=.8,this.viewControls.noZoom=!1,this.viewControls.noPan=!1,this.viewControls.staticMoving=!0,this.viewControls.dynamicDampingFactor=.3;var d=this;this.viewControls.onPanCallback=function(){d.currentAutoRotateSpeed=0,d.pauseAutoRotate=!0,d.unpauseRotateTimerId>0&&clearTimeout(d.unpauseRotateTimerId),d.unpauseRotateTimerId=setTimeout(function(){d.pauseAutoRotate=!1},5e3)},this.viewControls.keys=[65,83,68],window.addEventListener("resize",function(){d.onWindowResize()},!1),this.onWindowResize(),this.isActive=!0;var e=new THREE.MeshBasicMaterial({color:8978380});this.groundPlaneMesh=new THREE.Mesh(new THREE.BoxGeometry(10,.001,10,32,1,32),e);var d=this;setTimeout(function(){d.animate()},50)},onWindowResize:function(a){if(this.activeMeshRadius>0){var b=this.camera.fov*(Math.PI/180);this.camera.position.z=Math.abs(this.activeMeshRadius/Math.sin(b/2)),a&&(this.camera.position.y=.4*this.camera.position.z)}this.camera.aspect=this.domContainer.clientWidth/this.domContainer.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.domContainer.clientWidth,this.domContainer.clientHeight),this.viewControls.handleResize()},animate:function(){if(this.renderer.render(this.scene,this.camera),0!=this.autoRotateSpeed&&!this.pauseAutoRotate&&this.activeMesh){var a=1/60;if(this.currentAutoRotateSpeed!=this.autoRotateSpeed){var b=Math.PI*a*.025;Math.abs(this.currentAutoRotateSpeed-this.autoRotateSpeed)<b?this.currentAutoRotateSpeed=this.autoRotateSpeed:this.currentAutoRotateSpeed<this.autoRotateSpeed?this.currentAutoRotateSpeed+=b:this.currentAutoRotateSpeed-=b}this.activeMesh.rotation.y+=this.currentAutoRotateSpeed*a}if(this.isActive){var c=this;requestAnimationFrame(function(){c.animate()})}this.viewControls.update()},setModelFromBaseUri:function(a,b,c,d){if(this.showLoadingBox){var e=new THREE.MeshBasicMaterial({color:3407854,wireframe:!0,wireframeLinewidth:2});this.loadingProgress_OutlineBox=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),e);var f=new THREE.MeshBasicMaterial({color:585403});this.loadingProgress_FillBox=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),f),this.loadingProgress_FillBox.scale.y=.001,this.scene.add(this.loadingProgress_OutlineBox),this.scene.add(this.loadingProgress_FillBox),this.activeMeshRadius=1,this.onWindowResize()}var g=this,h=function(a){g.showLoadingBox&&(g.loadingProgress_OutlineBox&&g.scene.remove(g.loadingProgress_OutlineBox),g.loadingProgress_FillBox&&g.scene.remove(g.loadingProgress_FillBox),g.loadingProgress_OutlineBox=null,g.loadingProgress_FillBox=null),g.activeMesh&&(g.scene.remove(g.activeMesh),g.activeMesh=null),g.activeMesh=a;var b=new THREE.Box3;b.setFromObject(a);var c=new THREE.Vector3;c.subVectors(b.max,b.min),c.multiplyScalar(.5),c.add(b.min),c.multiplyScalar(-1),a.position.set(0,c.y,0),g.groundPlaneMesh.position.y=c.y;var d=new THREE.Vector3;d.subVectors(b.max,b.min),g.activeMeshRadius=.5*d.length(),g.onWindowResize(!0),a.updateMatrix(),setTimeout(function(){g.scene.add(a)},5)},i=function(a){g.showLoadingBox&&g.loadingProgress_FillBox&&(g.loadingProgress_FillBox.scale.y=a,0===g.loadingProgress_FillBox.scale.y&&(g.loadingProgress_FillBox.scale.y=.001)),b&&b(a)};pair.loadModelFromBaseUri(a,this.mtlLoader,this.objLoader,h,i,c,d)},close:function(){this.isActive=!1,this.domContainer.removeChild(this.renderer.domElement)}};var pair=pair||{};pair.DeepImageViewer=function(a){this.selectedMesh=null,this.activeLights=[],this.imageWidth=1,this.imageHeight=1,this.leftMouseIsDown=!1,this.helperBox=null,this.domContainer=null,this.onVisualizerReadyCallback=null,this.enableRotateGesture=!0,this.raycaster=new THREE.Raycaster,this.lastMousePos={clientX:0,clientY:0},this.cameraLookAtPos=new THREE.Vector3(0,0,0),this.activeModels=[],this.groundPlaneMeshSize={width:30,height:30},this.camera=null,this.sceneScalar=1,this.useDefaultSwatchDisplay=!0,this.renderer=null,this.useContinuousRendering=!1,this.isActive=!1,this.useFullFillOnResize=!1,this.scene=null,this.objLoader=null,this.mtlLoader=null,this.groundPlaneMesh=null,this.groundPlaneMaterial=null,this.viewerDomElementId=a,this.lastWindowSize={x:0,y:0},this.bgImageElem=null,this.useMagicImageSizeLogic=!1},pair.DeepImageViewer.TestDeepImageCameraInfo={fov:44.91,heightPitchRoll:{pitch:.5381357989403008,roll:1.3981206291173122e-17,height:1.3652763023320442},viewMatrix:[.9967596916827892,-.07686897832590982,-.02369128969815694,0,.07686897832590983,.8235424689324805,.5620222077780604,1.4200782188101746,-.023691289698156884,-.5620222077780606,.8267827772496915,0,0,0,0,1],errors:[],processingTimeSecs:1,sceneScalar:1},pair.isWebGLSupported=function(){try{var a=document.createElement("canvas");return!(!window.WebGLRenderingContext||!a.getContext("webgl")&&!a.getContext("experimental-webgl"))}catch(a){return!1}},pair.DeepImageViewer.prototype={init:function(a,b){if(this.domContainer=document.getElementById(this.viewerDomElementId),!pair.isWebGLSupported()){var c=document.createElement("span");return c.innerHTML="Sorry, unfortunately your browser does not support 3D graphics.",void this.domContainer.appendChild(c)}this.bgImageElem=document.createElement("img"),this.bgImageElem.className="pair-bg-image",this.bgImageElem.alt="3D Visualization",this.bgImageElem.style.display="none",this.bgImageElem.style.position="absolute",this.bgImageElem.style.left="0",this.bgImageElem.style.top="0",this.bgImageElem.style.width="100%",this.bgImageElem.style.height="auto",this.bgImageElem.style.zIndex="1100",this.bgImageElem.style.display="none",this.domContainer.appendChild(this.bgImageElem),this.tempLoadingImg=document.createElement("img"),this.tempLoadingImg.src=pair.spinnerImage,this.tempLoadingImg.alt="Loading",this.tempLoadingImg.style.position="absolute",this.tempLoadingImg.style.width="32px",this.tempLoadingImg.style.height="32px",this.tempLoadingImg.style.left="50%",this.tempLoadingImg.style.top="50%",this.tempLoadingImg.style.marginLeft="-16px",this.tempLoadingImg.style.marginTop="-16px",this.domContainer.appendChild(this.tempLoadingImg),this.initThreeJs();var d=this;this.bgImageElem.addEventListener("load",function(a){d.onBackgroundImageLoaded(a),d.tempLoadingImg&&d.domContainer.removeChild(d.tempLoadingImg),d.bgImageElem.style.display="block"}),pair.getOrientationFromDataUri(b,function(a){d.bgImageOrientationIndex=a,d.bgImageElem.src=b}),this.hookupInputEvents(),this.handleCameraData(a),this.useContinuousRendering||this.renderer.render(this.scene,this.camera),this.enableRotateGesture&&this.hookupRotateGesture()},hookupRotateGesture:function(){var a=this,b=!1,c=0,d=function(d){if(a.selectedMesh&&d.touches[1]){d.preventDefault(),b=!0;var e={x:d.touches[0].pageX,y:d.touches[0].pageY},f={x:d.touches[1].pageX,y:d.touches[1].pageY};c=Math.atan2(f.y-e.y,f.x-e.x)}},e=function(d){if(b&&d.touches[1]){d.preventDefault();var e={x:d.touches[0].pageX,y:d.touches[0].pageY},f={x:d.touches[1].pageX,y:d.touches[1].pageY},g=Math.atan2(f.y-e.y,f.x-e.x),h=-8.1/Math.PI,i=(g-c)*h;Math.abs(g-c)>Math.PI&&(i=0),c=g,a.selectedMesh.rotation.y+=i,a.render()}},f=this.renderer.domElement;f.addEventListener("touchmove",e,{capture:!1,passive:!1}),f.addEventListener("touchstart",d,{capture:!1,passive:!1}),f.addEventListener("touchend",function(){b=!1})},hookupInputEvents:function(){var a=this,b=this.renderer.domElement;b.addEventListener("click",function(b){a.onMouseTouch_Tap(b)}),b.addEventListener("touch",function(b){a.onMouseTouch_Tap(b)}),b.addEventListener("mousedown",function(b){a.onMouseTouchDown(b)}),b.addEventListener("mouseup",function(b){a.onMouseTouchUp(b)}),b.addEventListener("mousemove",function(b){a.onMouseTouch_Move(b)}),b.addEventListener("touchstart",function(b){a.onMouseTouchDown(b)}),b.addEventListener("touchend",function(b){a.onMouseTouchUp(b)}),b.addEventListener("touchmove",function(b){a.onMouseTouch_Move(b)})},setupSwatchUi:function(a){for(this.swatchContainerElem||(this.swatchContainerElem=document.createElement("div"),this.swatchContainerElem.style.position="absolute",this.swatchContainerElem.style.zIndex="1300",this.domContainer.appendChild(this.swatchContainerElem));this.swatchContainerElem.firstChild;)this.swatchContainerElem.removeChild(this.swatchContainerElem.firstChild);if(a.swatchOptions.length<2)return void(this.swatchContainerElem.style.display="none");this.swatchContainerElem.style.display="block";var b={x:this.domContainer.clientWidth,y:this.domContainer.clientHeight};b.x>b.y?(this.swatchContainerElem.style.width="10%",this.swatchContainerElem.style.height="100%",this.swatchContainerElem.style.left="0",this.swatchContainerElem.style.top="0"):(this.swatchContainerElem.style.width="100%",this.swatchContainerElem.style.height="10%",this.swatchContainerElem.style.left="0",this.swatchContainerElem.style.top="0");for(var c=(Math.floor(100/(a.swatchOptions.length+1)),0);c<a.swatchOptions.length;++c){var d=a.swatchOptions[c],e=document.createElement("div");e.style.width="100px",e.style.height="150px",e.style.display="inline-block";var f=document.createElement("img");f.style.width="100px",f.style.height="100px",c===a.activeSwatchIndex?f.style.border="solid 5px #0FA":f.style.padding="5px",f.src=a.pairBaseUri+d.thumbnailFileName;var g=function(b){return function(){for(var c=0;c<a.swatchOptions.length;++c)c===b?(a.swatchOptions[c].buttonDomElem.style.border="solid 5px #AAA",a.swatchOptions[c].buttonDomElem.style.padding="0"):(a.swatchOptions[c].buttonDomElem.style.border="none",a.swatchOptions[c].buttonDomElem.style.padding="5px");a.setSwatchIndex(b)}};f.addEventListener("click",g(d.swatchIndex)),d.buttonDomElem=f,e.appendChild(f);var h=document.createElement("span");h.innerHTML="<br />"+d.name,e.appendChild(h),this.swatchContainerElem.appendChild(e)}},close:function(){this.isActive=!1,this.domContainer.removeChild(this.bgImageElem),this.domContainer.removeChild(this.renderer.domElement),this.swatchContainerElem&&this.domContainer.removeChild(this.swatchContainerElem)},handleCameraData:function(a){var b=new THREE.Matrix4;b.fromArray(a.viewMatrix),b.transpose(),this.camera.applyMatrix(b),this.camera.fov=a.fov,this.camera.updateProjectionMatrix(),a.sceneScalar&&(this.sceneScalar=a.sceneScalar)},render:function(){this.renderer.render(this.scene,this.camera)},getCameraGroundRight:function(){var a=this.camera.getWorldDirection(),b=this.camera.up,c=new THREE.Vector3;return c.crossVectors(a,b),c.y=0,c.normalize(),c},getCameraGroundForward:function(){var a=this.camera.getWorldDirection();return a.y=0,a.normalize(),a},initUsingDemo:function(a){a=a||"https://app.pair3d.com/pair-deep-image/img/test-image.jpg",this.init(pair.DeepImageViewer.TestDeepImageCameraInfo,a)},onMouseTouch_Tap:function(a){if(!(a.touches&&a.touches.length>1||a.targetTouches&&a.targetTouches.length>1)){var b=a;a.changedTouches&&(b=a.changedTouches[0]);var c=$(this.renderer.domElement).offset(),d=b.clientX-c.left,e=b.clientY-c.top,f=new THREE.Vector2;f.x=d/this.renderer.domElement.clientWidth*2-1,f.y=-e/this.renderer.domElement.clientHeight*2+1,this.raycaster.setFromCamera(f,this.camera);var g=this.raycaster.intersectObjects(this.activeModels,!0);if(g.length>0){for(this.selectedMesh=g[0].object;this.selectedMesh.parent&&"Scene"!==this.selectedMesh.parent.type;)this.selectedMesh=this.selectedMesh.parent;this.helperBox&&this.scene.remove(this.helperBox);var h=((new THREE.Box3).setFromObject(this.selectedMesh),new THREE.MeshBasicMaterial({color:43775,transparent:!0,opacity:1,wireframe:!0}),{x:this.selectedMesh.position.x,y:this.selectedMesh.position.y,z:this.selectedMesh.position.z});this.selectedMesh.position.set(h.x,h.y,h.z),this.useContinuousRendering||this.renderer.render(this.scene,this.camera)}}},onMouseTouchDown:function(a){if(!(a.touches&&a.touches.length>1||a.targetTouches&&a.targetTouches.length>1)){this.leftMouseIsDown=!0;var b=a;a.changedTouches&&(b=a.changedTouches[0]),this.lastMousePos={clientX:b.clientX,clientY:b.clientY}}},onMouseTouchUp:function(a){a.touches&&a.touches.length>1||a.targetTouches&&a.targetTouches.length>1||(this.leftMouseIsDown=!1)},onMouseTouch_Move:function(a){if(this.leftMouseIsDown&&!(a.touches&&a.touches.length>1||a.targetTouches&&a.targetTouches.length>1)){var b=a;a.changedTouches&&(b=a.changedTouches[0]),this.onImageClick(b),a.preventDefault()}},onImageClick:function(a){if(this.leftMouseIsDown){var b={clientX:a.clientX,clientY:a.clientY},c={clientX:b.clientX-this.lastMousePos.clientX,clientY:b.clientY-this.lastMousePos.clientY},d=$(this.renderer.domElement).offset(),e=a.clientX-d.left,f=a.clientY-d.top+$(window).scrollTop();if(a.shiftKey){var g=.02*c.clientX;this.selectedMesh&&this.selectedMesh.rotateY(g),this.helperBox&&this.helperBox.rotateY(g),this.useContinuousRendering||this.renderer.render(this.scene,this.camera)}else{var h=new THREE.Vector2;h.x=e/this.renderer.domElement.clientWidth*2-1,h.y=-f/this.renderer.domElement.clientHeight*2+1,this.raycaster.setFromCamera(h,this.camera);var i=this.raycaster.intersectObjects([this.groundPlaneMesh],!1);if(i.length>0){var j=i[0].point;this.selectedMesh&&this.selectedMesh.position.set(j.x,j.y,j.z),this.helperBox&&this.helperBox.position.set(j.x,j.y,j.z),this.useContinuousRendering||this.renderer.render(this.scene,this.camera)}}this.lastMousePos=b}},initThreeJs:function(){function a(){d.isActive&&(d.renderer.render(d.scene,d.camera),requestAnimationFrame(a))}this.renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0});var b=this.domContainer.clientWidth||100,c=this.domContainer.clientHeight||100;this.camera=new THREE.PerspectiveCamera(74,b/c,.01,500),this.scene=new THREE.Scene,this.objLoader=new THREE.PairOBJLoader,this.mtlLoader=new THREE.PairMTLLoader,this.mtlLoader.setCrossOrigin(!0),this.scene.add(this.camera),this.renderer.setSize(b,c),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setClearColor(0,0),this.domContainer.appendChild(this.renderer.domElement),this.renderer.domElement.style.zIndex=1200,this.renderer.domElement.style.position="absolute",this.renderer.domElement.className="pair-deep-image-canvas",this.setupLights(),this.groundPlaneMaterial=new THREE.MeshBasicMaterial({color:8978380,transparent:!1,opacity:.2,wireframe:!0}),this.groundPlaneMesh=new THREE.Mesh(new THREE.BoxGeometry(this.groundPlaneMeshSize.width,.001,this.groundPlaneMeshSize.height,32,1,32),this.groundPlaneMaterial);var d=this;this.useContinuousRendering?requestAnimationFrame(a):this.renderer.render(this.scene,this.camera),window.addEventListener("resize",function(){d.delayedOnWindowResize()},!1),this.hookUpOrientationChange(),this.onWindowResize(),this.isActive=!0},onBackgroundImageLoaded:function(a){this.imageWidth=a.currentTarget.naturalWidth,this.imageHeight=a.currentTarget.naturalHeight;var b=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;if(pair.isOrientationRotated90(this.bgImageOrientationIndex)){var c=this.imageWidth;this.imageWidth=this.imageHeight,this.imageHeight=c,b||(this.bgImageElem.style.transform="rotate(90deg)",this.useMagicImageSizeLogic=!0)}this.camera.aspect=this.imageWidth/this.imageHeight,this.camera.updateProjectionMatrix(),this.onWindowResize(),this.groundPlaneMesh&&(this.scene.remove(this.groundPlaneMesh),this.groundPlaneMesh=null),this.groundPlaneMesh=new THREE.Mesh(new THREE.BoxGeometry(this.groundPlaneMeshSize.width,.001,this.groundPlaneMeshSize.height,32,1,32),this.groundPlaneMaterial),this.setupLights(),this.onVisualizerReadyCallback&&this.onVisualizerReadyCallback(),this.useContinuousRendering||this.renderer.render(this.scene,this.camera)},hookUpOrientationChange:function(){var a=this;window.addEventListener("orientationchange",function(){var b,c,d=100,e=1500,f={x:a.lastWindowSize.x,y:a.lastWindowSize.y},g=(window.innerHeight,0),h=function(){clearInterval(b),clearTimeout(c),b=null,c=null,a.lastWindowSize={x:window.innerWidth,y:window.innerHeight},a.onWindowResize(),setTimeout(function(){a.onWindowResize()},333),setTimeout(function(){a.onWindowResize()},1e3),setTimeout(function(){a.onWindowResize()},2e3),setTimeout(function(){a.onWindowResize()},3e3)};b=setInterval(function(){window.innerWidth===f.x&&window.innerHeight===f.y?++g>=d&&h():(g>d/4?h():d/=4,f={x:window.innerWidth,y:window.innerHeight},g=0)},10),c=setTimeout(function(){g=-1,h()},e)}),setTimeout(function(){a.lastWindowSize={x:window.innerWidth,y:window.innerHeight}},500)},delayedOnWindowResize:function(){var a=this;setTimeout(function(){a.onWindowResize()},110)},onWindowResize:function(){var a;if(this.domContainer)a={width:this.domContainer.clientWidth,height:this.domContainer.clientHeight};else{if(!this.renderer)return;a={width:this.renderer.domElement.clientWidth,height:this.renderer.domElement.clientHeight}}if(this.useFullFillOnResize){var b,c,d=0,e=0,f=0,g=0,h=a.width/a.height,i=this.imageWidth/this.imageHeight;if(1===this.imageHeight||1===this.imageWidth)return;i>1&&h<1?(b=a.height,c=a.height/this.imageHeight*this.imageWidth,g=(c-a.width)/2):i<1&&h>1?(c=a.width,b=a.width/this.imageWidth*this.imageHeight,f=(b-a.height)/2):h>i?(c=a.width,b=a.width/this.imageWidth*this.imageHeight,f=(b-a.height)/2):(b=a.height,c=a.height/this.imageHeight*this.imageWidth,g=(c-a.width)/2),this.bgImageElem.style.left=d+"px",this.bgImageElem.style.top=e+"px",this.bgImageElem.style.width=c.toString()+"px",this.bgImageElem.style.height=b.toString()+"px",this.renderer.domElement.style.left=d+"px",this.renderer.domElement.style.top=e+"px",this.bgImageElem.style.marginTop="-"+f+"px",this.renderer.domElement.style.marginTop="-"+f+"px",this.bgImageElem.style.marginLeft="-"+g+"px",this.renderer.domElement.style.marginLeft=g?"-"+g+"px":0,this.renderer.setSize(c,b)}else{var j,k,l=a.width/this.imageWidth,m=a.height/this.imageHeight,d=0,e=0;l<m?(j=this.imageWidth*l,k=this.imageHeight*l,e=Math.floor((a.height-k)/2)):(j=this.imageWidth*m,k=this.imageHeight*m,d=Math.floor((a.width-j)/2)),j=Math.floor(j),k=Math.floor(k),this.bgImageElem.style.left=d+"px",this.bgImageElem.style.top=e+"px",this.bgImageElem.style.width=j.toString()+"px",this.bgImageElem.style.height=k.toString()+"px",this.renderer.domElement.style.left=d+"px",this.renderer.domElement.style.top=e+"px",this.renderer.setSize(j,k)}if(this.useMagicImageSizeLogic){var n=this.bgImageElem.style.width;this.bgImageElem.style.width=this.bgImageElem.style.height,this.bgImageElem.style.height=n}this.useContinuousRendering||this.renderer.render(this.scene,this.camera)},setupLights:function(){for(var a=0;a<this.activeLights.length;++a)this.scene.remove(this.activeLights[a]);this.activeLights=[];var b=new THREE.AmbientLight(10066329);this.scene.add(b),this.activeLights.push(b);for(var c={x:1,y:1,z:1},d=[],a=0;a<d.length;++a){var e=d[a],f=new THREE.PointLight(e.color,e.strength,15);f.position.set(e.pos.x,e.pos.y,e.pos.z),this.scene.add(f),this.activeLights.push(f)}if(c){var g=new THREE.DirectionalLight(16777215,1.25);g.position.set(c.x,c.y,c.z),this.scene.add(g),this.activeLights.push(g)}},getCenteredPlacementPos:function(){var a=new THREE.Vector2(0,-.5);this.raycaster.setFromCamera(a,this.camera);var b=this.raycaster.intersectObjects([this.groundPlaneMesh],!1);0===b.length&&(a=new THREE.Vector2(0,-.5),this.raycaster.setFromCamera(a,this.camera),b=this.raycaster.intersectObjects([this.groundPlaneMesh],!1));var c=new THREE.Vector3(0,.4,-4);if(b.length>0){var d=b[0].point;c.set(d.x,d.y,d.z)}return c},addCube:function(a){var b=new THREE.MeshLambertMaterial({color:1179596}),c=new THREE.Mesh(new THREE.CubeGeometry(.5,.5,.5),b),d=this.getCenteredPlacementPos();c.position.set(d.x,d.y,d.z),c.scale.set(this.sceneScalar,this.sceneScalar,this.sceneScalar),this.scene.add(c),this.selectedMesh=c,a&&a(c),this.useContinuousRendering||this.renderer.render(this.scene,this.camera)},createShadowPlaneForMesh:function(a){var b=document.createElement("img"),c=new THREE.Texture(b),d=this;b.onload=function(){c.needsUpdate=!0,d.useContinuousRendering||d.renderer.render(d.scene,d.camera)},b.src=pair.blackDotImage;var e=new THREE.Box3;e.setFromObject(a);var f=new THREE.Vector3;f.subVectors(e.max,e.min),f.multiplyScalar(1.75);var g=new THREE.MeshBasicMaterial({map:c,opacity:.45}),h=new THREE.Mesh(new THREE.PlaneGeometry(f.x,f.z),g);h.rotation.set(-Math.PI/2,0,0),h.scale.set(1/this.sceneScalar,1/this.sceneScalar,1/this.sceneScalar),a.add(h),this.useContinuousRendering||this.renderer.render(this.scene,this.camera)},addModelFromBaseUri:function(a,b,c,d){var e=this,f=function(a){e.helperBox&&(e.scene.remove(e.helperBox),e.helperBox=null),a.pairViewer=e,e.scene.add(a),e.activeModels.push(a);var c=e.getCenteredPlacementPos();a.position.set(c.x,c.y,c.z),a.scale.set(e.sceneScalar,e.sceneScalar,e.sceneScalar),e.helperBox&&e.helperBox.position.set(c.x,c.y,c.z),e.selectedMesh=a,b&&b(a),e.useContinuousRendering||e.renderer.render(e.scene,e.camera),setTimeout(function(){e.useContinuousRendering||e.renderer.render(e.scene,e.camera)},250),setTimeout(function(){e.useContinuousRendering||e.renderer.render(e.scene,e.camera)},1e3),setTimeout(function(){e.useContinuousRendering||e.renderer.render(e.scene,e.camera)},2e3),e.useDefaultSwatchDisplay&&e.setupSwatchUi(a)};pair.loadModelFromBaseUri(a,this.mtlLoader,this.objLoader,f,null,c,d)},rotateSelection:function(a){this.selectedMesh&&this.selectedMesh.rotateY(a),this.helperBox&&this.helperBox.rotateY(a),this.useContinuousRendering||this.renderer.render(this.scene,this.camera)}};